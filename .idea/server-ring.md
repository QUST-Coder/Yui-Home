# Server Ring 服务环
传统的判题系统(例如PC^2)存在一个缺点: 所有数据信息必须经过PC^2服务器，一旦这台服务器宕机，整场比赛将陷入停滞。  
为解决这一问题，设计一个服务环代替单点服务器是必要的。  
### 工作原理
比赛开始前，需要在客户端手动配置初始服务器（可以使一个，也可以是多个）。  
#### 客户端工作流程:  
1. 客户端启动，初始状态为【离线】，尝试连接到预先配置的初始服务器列表中的任意一个.  
2. 连接成功后，更新本地状态为【未登录】，输入账号密码进行登录，登陆成功则状态改变为【已登录】.
3. 从当前服务器获取Judge机地址并进行连接。连接成功后状态改变为【已连接到Judge】.
4. 从Judge机获取完整服务器列表缓存在本地.
5. 选手提交的代码会先提交到本地队列缓存，选手可以看到提交队列的状态. 客户端将与JudgeClient进行不断通信以完成提交和结果获取. 
6. 一旦当前JudgeClient不可用则在缓存列表中寻找可用JudgeClient，此时状态切换为【远程Judge不可用】和【正在寻找Judge...】. 建立新连接之后将重复步骤3.

### Judge端工作流程
1. Judge端启动，连接到预先配置的初始服务器. （这一步可在赛前完成）
2. 与服务器端保持队列同步，即如果有新的服务器加入到整个网络中，当前Judge端将从初始服务器处获取到更新后的列表。这个列表在当前服务器宕机时将为其他众多Judge端恢复连接提供帮助.  
3. 等待UserClient进行连接,连接后将进入等待判题状态.
